<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Каталог — CyberX</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;800&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div id="loader" class="loader">
    <div class="loader-text">INITIALIZING ...</div>
    <div class="loader-bar"></div>
  </div>

  <header>
    <div class="container header-container">
      <div class="logo">CYBER<span>X</span></div>
      <nav>
        <a href="index.html">Главная</a>
        <a href="tournaments.html">Турниры</a>
        <a href="news.html">Новости</a>
        <a href="catalog.html" class="active">Каталог</a>
        <a href="contacts.html">Контакты</a>
        <div id="auth-buttons" class="auth-buttons">
          <a href="login.html" class="btn-auth">Вход</a>
        </div>
      </nav>
    </div>
  </header>

  <main class="container">
    <h1 class="glitch" data-text="ВИТРИНА">ВИТРИНА</h1>
    <p>Закажите прямо к своему ПК! Доставка за 5 минут.</p>

    <div class="catalog-grid" id="catalog-items"></div>

    <div class="cart-summary">
      <h3>Ваш заказ: <span id="cart-count">0</span> поз.</h3>
      <button class="btn" onclick="clearCart()">Очистить</button>
      <button class="btn" onclick="checkout()">Оформить заказ</button>
    </div>
  </main>

  <footer class="cyber-footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-col">
          <div class="footer-logo">CYBER<span>X</span></div>
          <p>Киберспортивные арены нового поколения</p>
        </div>
        <div class="footer-col">
          <h4>Навигация</h4>
          <ul>
            <li><a href="index.html">Главная</a></li>
            <li><a href="tournaments.html">Турниры</a></li>
            <li><a href="news.html">Новости</a></li>
            <li><a href="catalog.html">Каталог</a></li>
            <li><a href="contacts.html">Контакты</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Клубы</h4>
          <ul>
            <li>Барнаул</li>
            <li>Новосибирск</li>
            <li>Москва</li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Связаться</h4>
          <p>+7 (999) 123-45-67</p>
          <p>barnaul@cyberx.ru</p>
          <div class="footer-social">
            <a href="https://t.me/cyberx_community" target="_blank">Telegram</a> •
            <a href="https://vk.com/cyberx" target="_blank">VK</a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        &copy; 2025 CyberX . Все права защищены. 
      </div>
    </div>
  </footer>

  <script src="js/auth.js"></script>
  <script src="js/tilt.js"></script>
  <script>
    const products = [
      { id: 1, name: "Энергетик Red Bull", price: 199 },
      { id: 2, name: "Кола 0.5л", price: 120 },
      { id: 3, name: "Пицца «Пепперони»", price: 450 },
      { id: 4, name: "Наггетсы (6 шт)", price: 220 },
      { id: 5, name: "Чипсы Lays", price: 90 },
      { id: 6, name: "Шоколадный батончик", price: 70 }
    ];

    function renderCatalog() {
      const container = document.getElementById('catalog-items');
      if (!container) return;
      container.innerHTML = products.map(p => `
        <div class="catalog-item tilt-card" data-tilt>
          <h3>${p.name}</h3>
          <p class="price">${p.price} ₽</p>
          <button class="btn" onclick="addToCart(${p.id})">➕ В заказ</button>
        </div>
      `).join('');
    }

    function getCart() {
      return JSON.parse(localStorage.getItem('cyberxOrder') || '[]');
    }

    function addToCart(productId) {
      const cart = getCart();
      const product = products.find(p => p.id === productId);
      if (product) {
        cart.push(product);
        localStorage.setItem('cyberxOrder', JSON.stringify(cart));
        updateCartUI();
        alert(`✅ ${product.name} добавлен в заказ!`);
      }
    }

    function updateCartUI() {
      const count = getCart().length;
      document.getElementById('cart-count').textContent = count;
    }

    function clearCart() {
      localStorage.removeItem('cyberxOrder');
      updateCartUI();
      alert('Корзина очищена.');
    }

    function checkout() {
      const cart = getCart();
      if (cart.length === 0) {
        alert('Ваш заказ пуст!');
        return;
      }
      const total = cart.reduce((sum, item) => sum + item.price, 0);

      const email = localStorage.getItem('cyberxCurrent');
      if (email) {
        const users = JSON.parse(localStorage.getItem('cyberxUsers') || '[]');
        const user = users.find(u => u.email === email);
        if (user) {
          user.lastOrder = {
            items: cart,
            total: total,
            date: new Date().toLocaleDateString()
          };
          localStorage.setItem('cyberxUsers', JSON.stringify(users));
          if (typeof logActivity === 'function') {
            logActivity(email);
          }
        }
      }

      alert(`Заказ оформлен!\nПозиций: ${cart.length}\nСумма: ${total} ₽\nДоставка к вашему ПК.`);
      localStorage.removeItem('cyberxOrder');
      updateCartUI();
    }

    document.addEventListener('DOMContentLoaded', () => {
      renderCatalog();
      updateCartUI();
      if (typeof updateAuthButtons === 'function') {
        updateAuthButtons();
      }
    });

    window.addEventListener('load', () => {
      setTimeout(() => document.getElementById('loader')?.remove(), 1800);
    });
  </script>
</body>
</html>
